Description: fix authentication timeout on certain slower systems
Bug: https://bugs.freedesktop.org/show_bug.cgi?id=86431
Origin: backport, http://cgit.freedesktop.org/dbus/dbus/commit/?h=dbus-1.6&id=39f4b36ba546818a7dc00bfdcde9b21bb8abcaac
Origin: backport, http://cgit.freedesktop.org/dbus/dbus/commit/?h=dbus-1.6&id=d1ab5857287430766837c63643d143ba434160b2

Index: dbus-1.4.18/bus/config-parser.c
===================================================================
--- dbus-1.4.18.orig/bus/config-parser.c	2014-11-25 14:46:42.343834029 -0500
+++ dbus-1.4.18/bus/config-parser.c	2014-11-25 14:46:42.339834000 -0500
@@ -427,7 +427,7 @@
        * and legitimate auth will fail.  If interactive auth (ask user for
        * password) is allowed, then potentially it has to be quite long.
        */
-      parser->limits.auth_timeout = 5000; /* 5 seconds */
+      parser->limits.auth_timeout = 30000; /* 30 seconds */
 
       /* Do not allow a fd to stay forever in dbus-daemon
        * https://bugs.freedesktop.org/show_bug.cgi?id=80559
Index: dbus-1.4.18/bus/connection.c
===================================================================
--- dbus-1.4.18.orig/bus/connection.c	2014-11-25 14:46:42.343834029 -0500
+++ dbus-1.4.18/bus/connection.c	2014-11-25 14:46:42.343834029 -0500
@@ -887,6 +887,14 @@
 
           if (elapsed >= (double) auth_timeout)
             {
+              /* Unfortunately, we can't identify the connection: it doesn't
+               * have a unique name yet, we don't know its uid/pid yet,
+               * and so on. */
+              bus_context_log (connections->context, DBUS_SYSTEM_LOG_INFO,
+                  "Connection has not authenticated soon enough, closing it "
+                  "(auth_timeout=%dms, elapsed: %.0fms)",
+                  auth_timeout, elapsed);
+
               _dbus_verbose ("Timing out authentication for connection %p\n", connection);
               dbus_connection_close (connection);
             }
